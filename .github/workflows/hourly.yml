name: ConvAI Calls to Master Doc (Every 5 minutes)

on:
  schedule:
    - cron: '*/5 * * * *'

jobs:
  convai_to_master_doc:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v3
        with:
          python-version: '3.10'

      - name: Install dependencies
        run: pip install google-api-python-client google-auth google-auth-oauthlib requests

      - name: Export secrets to env
        run: |
          echo "MASTER_DOC_ID=${{ secrets.MASTER_DOC_ID }}" >> $GITHUB_ENV
          echo "TZ_OFFSET_HOURS=${{ secrets.TZ_OFFSET_HOURS }}" >> $GITHUB_ENV

      - name: Run ConvAI download script
        run: python download_convai_to_master_doc.py
